동굴 창고
이전다음
문제
페인트 칠을 좋아하는 유니는 N개의 동굴을 가지고 있다. 유니는 그 동굴들을 창고로 쓰고 있는데, 창고의 종류는 두 가지이다. 하나는 페인트 창고이고, 다른 하나는 장비 창고이다. 창고와 창고 사이는 통로로 연결이 되어 있는데, 이동이 편하게 통로에 철길을 만들려고 한다.

철길을 만드는 조건은 3가지가 있다.

철길은 페인트 창고와 장비 창고를 연결하는 통로에만 만든다.
철길은 한 창고에서 모든 창고로 갈 수 있도록 연결이 되어야 한다.
철길을 만드는 비용을 최소화 하기 위해서 철길은 최단 거리가 되어야 한다.
만약 동굴이 왼쪽 그림과 같다면, 오른쪽 그림의 보라색 선과 같이 철길을 만들면 위의 3가지 조건을 만족할 수 있다.



이때, 주어지는 동굴의 통로를 이용하여 철길의 길이를 구해보자.



입력
입력의 첫째 줄에 동글의 수 N와 동굴을 연결하는 통로의 수 M이 주어진다. (2 ≤ N ≤ 1,000) (1 ≤ M ≤ 10,000) 둘째 줄에 각 동굴이 페인트 창고라면 M, 장비 차아고라면 W이 주어진다. 다음 M개의 줄에 u v d가 주어지며 u동굴와 v동굴에 통로가 있으며 이 거리는 d임을 나타낸다. (1 ≤ u, v ≤ N) , (1 ≤ d ≤ 1,000)

출력
지니가 만든 철길의 길이를 출력한다. (모든 동굴을 연결하는 통로가 없을 경우 -1을 출력한다.)

예제 입력1
copy5 7
M W W W M
1 2 12
1 3 10
4 2 5
5 2 5
2 5 10
3 4 3
5 4 7
예제 출력1
copy34