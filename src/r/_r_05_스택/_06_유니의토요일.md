유니의 토요일
이전다음
문제
유니는 토요일을 맞아 노드의 수가 무한한 완전이진트리에서 놀고 있다.
playtree이 트리는 루트가 1이며 아래로 내려가며 왼쪽부터 오른쪽 순서대로 번호가 붙어있다.
예를 들어, 루트의 왼쪽 자식은 2, 오른쪽 자식은 3번이며, i번 노드의 왼쪽 자식은 2 x i번, i번 노드의 오른쪽 자식은 2 x i + 1번의 번호가 붙어 있다.

즉, 3번 노드의 왼쪽 자식은 6번이고 오른쪽 자식은 7번이다.

유니는 초기에 S번 노드에 위치해 있으며, N번의 이동을 진행한다.
각 이동은 U, L, R 중 하나의 문자로 표현된다

U : 현재 위치에서 부모 노드로 이동한다.
L : 왼쪽 자식 노드로 이동한다.
R : 오른쪽 자식 노드로 이동한다.
유니의 이동 횟수 N과 초기 위치 S, 유니가 이동한 방식이 문자열로 주어질 때, 유니가 마지막에 위치한 노드의 번호를 출력하는 프로그램을 작성하시오.

유니는 초기에 1 이상 1,000,000,000,000,000,000 이하의 번호가 붙어 있는 노드에서 출발하며, 최종 도착 노드의 번호도 1 이상 1,000,000,000,000,000,000 이하임이 보장된다.

*참고 c, c++의 long long 자료형과 java의 long 자료형은 최댓값이 약 9 * 10^18 이다. java의 BigInteger와 python의 정수 자료형은 수 범위의 제한이 없지만 9 * 10^18보다 큰 수를 계산할 때는 level6의 큰자릿수 연산처럼 문자열로 연산 되기 때문에 굉장히 느리게 계산 된다.

입력
첫 째줄에 이동 횟수 N과 초기 위치 S가 공백으로 구분된 정수로 주어진다.
둘 째줄에 이동한 방식 U, L, R이 섞여있는 문자열이 주어진다.
(1 <= N <= 500,000 , 1<=S<=1,000,000,000,000,000,000)

출력
유니가 마지막에 위치한 노드의 번호를 출력하시오.



예제 입력
copy6 100
LULLRU
예제 출력
copy400
알고리즘랩스 알고리즘 경진대회(1회) / Regular Round 3  