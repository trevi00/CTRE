빵 줍기
이전다음
문제
유니와 지니는 보드게임을 하려고 합니다.

보드게임의 이름은 빵줍기!. 당신은 이 게임이 끝날때 까지 유니와 지니가 캐릭터를 몇 번 움직이게 될지 예측하려고 합니다.

유니와 지니는 자신의 캐릭터 하나를 보드 위에 올려놓고 게임을 시작합니다. 게임 보드는 1x1 크기 정사각 격자 NxM개로 이루어져 있으며, 보드 안에는 빵이 놓여져 있는 칸과 없는 칸이 있습니다. 빵이 있는 칸에만 캐릭터를 이동 시킬 수 있으며, 처음 캐릭터를 올려놓는 곳은 항상 빵이 있는 곳입니다. 또한 캐릭터를 보드 밖으로 이동할 수 없습니다. 빵은 그 위에 있던 캐릭터가 다른 곳으로 이동함과 동시에 사라집니다. 양 플레이어는 번갈아가며 자기 차례에 자신의 캐릭터를 상하좌우로 인접한 4개의 칸 중에서 빵이 있는 칸으로 옮겨야 합니다.

다음과 같은 2가지 상황에서 패자와 승자가 정해지며, 게임이 종료됩니다.

움직일 차례인데 캐릭터의 상하좌우 주변 4칸이 모두 빵이 없거나 보드 밖이라서 이동할 수 없는 경우, 해당 차례 플레이어는 패배합니다.
두 캐릭터가 같은 칸 위에 있을 때, 상대 플레이어의 캐릭터가 다른 칸으로 이동하여 자신의 캐릭터가 서있던 칸의 빵이 사라지게 되면 패배합니다.
게임은 항상 유니가 먼저 시작합니다. 유니와 지니는 최적의 플레이를 합니다. 즉, 이길 수 있는 플레이어는 최대한 빨리 승리하도록 플레이하고, 질 수밖에 없는 플레이어는 최대한 오래 버티도록 플레이합니다. '이길 수 있는 플레이어'는 실수만 하지 않는다면 항상 이기는 플레이어를 의미하며, '질 수밖에 없는 플레이어'는 최선을 다해도 상대가 실수하지 않으면 항상 질 수밖에 없는 플레이어를 의미합니다. 최대한 오래 버틴다는 것은 양 플레이어가 캐릭터를 움직이는 횟수를 최대화한다는 것을 의미합니다.

아래 그림은 초기 보드의 상태와 유니와 지니의 위치를 나타내는 예시입니다.

point

위와 같은 경우, 유니는 실수만 하지 않는다면 항상 이길 수 있습니다. 따라서 유니는 이길 수 있는 플레이어이며, 지니는 질 수밖에 없는 플레이어입니다. 다음은유니와 지니가 최적의 플레이를 하는 과정을 나타냅니다.

유니가 초기 위치 (1, 0)에서 (1, 1)로 이동합니다. 유니가 (0, 0)이나 (2, 0)으로 이동할 경우 승리를 보장할 수 없습니다. 따라서 무조건 이길 방법이 있는 (1, 1)로 이동합니다.
지니는 (1, 1)로 이동할 경우, 바로 다음 차례에 유니가 위 또는 아래 방향으로 이동하면 발판이 없어져 패배하게 됩니다. 질 수밖에 없는 플레이어는 최대한 오래 버티도록 플레이하기 때문에 (1, 1)로 이동하지 않습니다. (1, 2)에서 위쪽 칸인 (0, 2)로 이동합니다.
유니가 (1, 1)에서 (0, 1)로 이동합니다.
지니에게는 남은 선택지가 (0, 1)밖에 없습니다. 따라서 (0, 2)에서 (0, 1)로 이동합니다.
유니가 (0, 1)에서 (0, 0)으로 이동합니다. 이동을 완료함과 동시에 지니가 서있던 (0, 1)의 발판이 사라집니다. 지니가 패배합니다.
만약 과정 2에서 지니가 아래쪽 칸인 (2, 2)로 이동하더라도 A는 (2, 1)로 이동하면 됩니다. 이후 지니가 (2, 1)로 이동, 다음 차례에 유니가 (2, 0)으로 이동하면 지니가 패배합니다.
위 예시에서 유니와 지니가 최적의 플레이를 했을 경우, 캐릭터의 이동 횟수 합은 5입니다. 최적의 플레이를 하는 방법은 여러 가지일 수 있으나, 이동한 횟수는 모두 5로 같습니다.

게임 보드의 초기 상태와 유니, 지니의 캐릭터의 초기 위치가 주어질 때 두 캐릭터가 움직인 횟수의 합을 구하는 프로그램을 작성하시오.

입력
첫째 줄에 N, M이 공백으로 구분되어 주어진다.

둘째 줄부터 N줄에 걸쳐 게임 보드의 정보가 주어진다. 1로 표현된 칸은 빵이 있는 위치, 0으로 표현된 칸은 빵이 없는 위치를 의미한다.

N + 2번째 줄에는 유니의 좌표가 공백으로 구분되어 주어진다.

N + 3번째 줄에는 지니의 좌표가 공백으로 구분되어 주어진다.

(1 ≤ N ≤ 5, 1 ≤ M ≤ 5)

출력
두 캐릭터의 이동 수의 합을 출력한다.

예제 입력
copy3 3
1 1 1
1 1 1
1 1 1
1 0
1 2
예제 출력
copy5